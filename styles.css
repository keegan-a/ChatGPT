:root {
  --font-body: 'MS Sans Serif', 'Segoe UI', Tahoma, sans-serif;
  --font-mono: 'Inconsolata', 'Courier New', monospace;
  --z-taskbar: 50;
  --z-start-menu: 60;
  --z-screensaver: 80;
  --window-border: #000;
  --window-shadow: rgba(0, 0, 0, 0.4);
  --accent: #0078d7;
  --accent-light: #5aa9ff;
  --accent-dark: #004a9f;
  --bg-base: #c0c0c0;
  --bg-panel: #ece9d8;
  --text-primary: #000;
  --text-secondary: #222;
  --taskbar-bg: linear-gradient(#3a6ea5, #274472);
  --start-menu-bg: linear-gradient(#1c4a7c, #0e2949);
  --wallpaper: linear-gradient(135deg, #2c8c52 0%, #8cd1ff 100%);
}

body {
  margin: 0;
  min-height: 100vh;
  font-family: var(--font-body);
  background: #111;
  color: var(--text-primary);
  overflow: hidden;
}

#desktop {
  position: relative;
  width: 100vw;
  height: 100vh;
  overflow: hidden;
}

#wallpaper {
  position: absolute;
  inset: 0;
  background: var(--wallpaper);
  background-size: cover;
  background-position: center;
  filter: saturate(1.2);
}

#pipes-canvas {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  display: none;
  z-index: var(--z-screensaver);
  background: radial-gradient(circle at center, rgba(0, 0, 0, 0.3), #000 80%);
}

body.screensaver #pipes-canvas {
  display: block;
}

.taskbar {
  position: absolute;
  inset-inline: 0;
  bottom: 0;
  height: 42px;
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 4px 8px;
  background: var(--taskbar-bg);
  color: #fff;
  box-shadow: 0 -2px 8px rgba(0, 0, 0, 0.3);
  z-index: var(--z-taskbar);
}

.taskbar__start {
  font-family: var(--font-body);
  font-weight: 700;
  letter-spacing: 0.04em;
  padding: 6px 16px;
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0.5);
  background: linear-gradient(#fefefe, #cfcfcf);
  color: #1e3a5f;
  text-transform: uppercase;
  cursor: pointer;
  box-shadow: inset -1px -1px 0 rgba(0, 0, 0, 0.4), inset 1px 1px 0 rgba(255, 255, 255, 0.6);
}

.taskbar__start:focus-visible {
  outline: 2px solid #fff;
}

.taskbar__items {
  display: flex;
  flex: 1 1 auto;
  gap: 4px;
  align-items: center;
  height: 100%;
}

.taskbar__item {
  min-width: 120px;
  height: 32px;
  padding: 4px 12px;
  border-radius: 4px;
  border: 1px solid rgba(255, 255, 255, 0.4);
  background: linear-gradient(rgba(255, 255, 255, 0.4), rgba(0, 0, 0, 0.15));
  color: #fff;
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  box-shadow: inset -1px -1px 0 rgba(0, 0, 0, 0.3), inset 1px 1px 0 rgba(255, 255, 255, 0.4);
}

.taskbar__item--active {
  border-color: #fff;
  background: linear-gradient(rgba(255, 255, 255, 0.7), rgba(0, 0, 0, 0.2));
}

.taskbar__extras {
  display: flex;
  align-items: center;
  gap: 6px;
}

.taskbar__theme,
.taskbar__icon {
  height: 32px;
  padding: 4px 12px;
  border-radius: 4px;
  border: none;
  background: rgba(255, 255, 255, 0.25);
  color: #fff;
  font-family: var(--font-body);
}

.taskbar__icon {
  cursor: pointer;
}

#taskbar-clock {
  min-width: 80px;
  text-align: right;
  font-feature-settings: 'tnum';
}

.start-menu {
  position: absolute;
  bottom: 48px;
  left: 8px;
  width: 260px;
  background: var(--start-menu-bg);
  color: #fff;
  border-radius: 6px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.45);
  display: none;
  z-index: var(--z-start-menu);
}

.start-menu[aria-hidden='false'] {
  display: block;
}

.start-menu__header {
  padding: 12px 16px;
  font-weight: 700;
  letter-spacing: 0.04em;
  background: rgba(0, 0, 0, 0.2);
}

.start-menu__search {
  width: calc(100% - 24px);
  margin: 8px 12px;
  padding: 6px 10px;
  border-radius: 4px;
  border: none;
  font-family: var(--font-body);
}

.start-menu__list {
  list-style: none;
  margin: 0;
  padding: 8px;
  max-height: 300px;
  overflow-y: auto;
}

.start-menu__item {
  padding: 8px;
  border-radius: 4px;
  display: flex;
  align-items: center;
  gap: 10px;
  cursor: pointer;
}

.start-menu__item:hover,
.start-menu__item:focus-visible {
  background: rgba(255, 255, 255, 0.18);
  outline: none;
}

.window {
  position: absolute;
  top: 80px;
  left: 80px;
  width: 460px;
  min-width: 280px;
  min-height: 220px;
  background: var(--bg-panel);
  border: 2px solid var(--window-border);
  box-shadow: 8px 12px 24px var(--window-shadow);
  display: flex;
  flex-direction: column;
  border-radius: 6px;
  overflow: hidden;
}

.window[hidden] {
  display: none !important;
}

.window__titlebar {
  flex: 0 0 auto;
  background: linear-gradient(var(--accent-light), var(--accent-dark));
  color: #fff;
  padding: 8px 12px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  cursor: move;
}

.window__title {
  font-weight: 700;
}

.window__controls {
  display: flex;
  gap: 6px;
}

.window__button {
  width: 28px;
  height: 24px;
  border: none;
  border-radius: 4px;
  background: rgba(255, 255, 255, 0.2);
  color: #fff;
  font-family: var(--font-body);
  font-size: 14px;
  cursor: pointer;
}

.window__button:focus-visible {
  outline: 2px solid #fff;
}

.window__body {
  flex: 1 1 auto;
  background: rgba(255, 255, 255, 0.8);
  padding: 16px;
  overflow: auto;
}

.window__resize-handle {
  position: absolute;
  bottom: 0;
  right: 0;
  width: 18px;
  height: 18px;
  cursor: nwse-resize;
  background: linear-gradient(135deg, transparent 40%, rgba(0, 0, 0, 0.35));
}

.panel-grid {
  display: grid;
  gap: 12px;
}

.panel-grid--two {
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
}

.panel {
  border-radius: 6px;
  padding: 12px;
  background: rgba(255, 255, 255, 0.92);
  box-shadow: inset 0 0 0 1px rgba(0, 0, 0, 0.12);
}

.panel__heading {
  display: flex;
  align-items: center;
  justify-content: space-between;
  font-weight: 700;
  margin-bottom: 8px;
}

input,
select,
button,
textarea {
  font-family: var(--font-body);
}

.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}

input[type='number'] {
  width: 100%;
}

.table {
  width: 100%;
  border-collapse: collapse;
  font-size: 0.92rem;
}

.table th,
.table td {
  border: 1px solid rgba(0, 0, 0, 0.1);
  padding: 6px;
  text-align: left;
}

.table tr:nth-child(even) {
  background: rgba(0, 0, 0, 0.04);
}

.badge {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  padding: 2px 8px;
  border-radius: 999px;
  font-size: 0.8rem;
  background: var(--accent-light);
  color: #fff;
}

.meter {
  width: 100%;
  height: 18px;
  border-radius: 999px;
  overflow: hidden;
  background: rgba(0, 0, 0, 0.1);
}

.meter__fill {
  height: 100%;
  background: linear-gradient(90deg, #ff6b6b, #feca57, #1dd1a1);
}

.timeline {
  display: flex;
  gap: 16px;
  padding: 8px 0;
  overflow-x: auto;
}

.timeline__item {
  min-width: 160px;
  padding: 10px;
  border-radius: 6px;
  background: rgba(0, 0, 0, 0.06);
}

.note-list {
  list-style: none;
  padding: 0;
  margin: 0;
  display: grid;
  gap: 8px;
}

.note-list li {
  padding: 8px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.06);
}

.quick-actions {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
}

.quick-actions button {
  flex: 1 1 auto;
  min-width: 160px;
  padding: 8px 12px;
  border-radius: 4px;
  border: 1px solid rgba(0, 0, 0, 0.2);
  background: rgba(255, 255, 255, 0.8);
  cursor: pointer;
}

.currency-switcher {
  display: inline-flex;
  gap: 6px;
  align-items: center;
}

.currency-switcher select {
  padding: 4px 8px;
}

.window--showcase {
  max-width: 720px;
}

.showcase {
  display: grid;
  gap: 12px;
  background: rgba(255, 255, 255, 0.96);
  padding: 16px;
  border-radius: 12px;
  box-shadow: inset 0 0 0 2px rgba(255, 255, 255, 0.8);
}

.showcase__hero {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.showcase__grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 12px;
}

.showcase__card {
  padding: 12px;
  border-radius: 8px;
  background: rgba(0, 0, 0, 0.05);
}

kbd {
  padding: 2px 6px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.12);
  font-size: 0.8rem;
}

/* Theme variants */
.theme-winxp {
  --accent: #2b5797;
  --accent-light: #4f81d1;
  --accent-dark: #1a3c6d;
  --bg-base: #d7e6fe;
  --bg-panel: rgba(255, 255, 255, 0.95);
  --taskbar-bg: linear-gradient(#245edb, #123f8b);
  --start-menu-bg: linear-gradient(#123f8b, #0c2a5c);
  --wallpaper: radial-gradient(circle at 30% 20%, #4cc6ff, #1a59a0 60%, #0b1d36 100%);
}

.theme-winvista {
  --accent: #1e90ff;
  --accent-light: #6cb5ff;
  --accent-dark: #0f4c81;
  --bg-base: rgba(255, 255, 255, 0.8);
  --bg-panel: rgba(255, 255, 255, 0.92);
  --taskbar-bg: linear-gradient(#0e1f33, #05111d);
  --start-menu-bg: linear-gradient(#1f3c63, #0f1d30);
  --wallpaper: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1920 1080" preserveAspectRatio="xMidYMid slice"%3E%3ClinearGradient id="g" x1="0" y1="0" x2="1" y2="1"%3E%3Cstop offset="0" stop-color="%23002f6c"/%3E%3Cstop offset="0.45" stop-color="%23029dbb"/%3E%3Cstop offset="1" stop-color="%2302c39a"/%3E%3C/linearGradient%3E%3Crect fill="url(%23g)" width="1920" height="1080"/%3E%3Ccircle cx="1460" cy="320" r="280" fill="rgba(255,255,255,0.28)"/%3E%3Ccircle cx="420" cy="780" r="360" fill="rgba(255,255,255,0.18)"/%3E%3C/svg%3E');
  background-size: cover;
}

.theme-mac2000s {
  --accent: #5f5ff8;
  --accent-light: #9d9dff;
  --accent-dark: #3d3da9;
  --bg-base: #f2f2f2;
  --bg-panel: rgba(255, 255, 255, 0.9);
  --taskbar-bg: linear-gradient(#3f3f3f, #1f1f1f);
  --start-menu-bg: linear-gradient(#333, #111);
  --wallpaper: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2560 1600"%3E%3ClinearGradient id="sky" x1="0" y1="0" x2="0" y2="1"%3E%3Cstop offset="0" stop-color="%2399c9ff"/%3E%3Cstop offset="1" stop-color="%234488ff"/%3E%3C/linearGradient%3E%3ClinearGradient id="hills" x1="0" y1="0" x2="1" y2="1"%3E%3Cstop offset="0" stop-color="%230a8739"/%3E%3Cstop offset="1" stop-color="%2312c45a"/%3E%3C/linearGradient%3E%3Crect fill="url(%23sky)" width="2560" height="1600"/%3E%3Cpath d="M0 1080 C400 960 620 920 960 1000 C1320 1080 1640 940 2000 980 C2320 1020 2560 940 2560 940 L2560 1600 L0 1600 Z" fill="url(%23hills)"/%3E%3C/svg%3E');
}

.theme-win95 {
  --accent: #0b5394;
  --accent-light: #3d85c6;
  --accent-dark: #073763;
  --bg-base: #c0c0c0;
  --bg-panel: #ece9d8;
  --taskbar-bg: linear-gradient(#38761d, #274e13);
  --start-menu-bg: linear-gradient(#274e13, #153610);
  --wallpaper: url('data:image/svg+xml,%3Csvg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 600"%3E%3Crect width="800" height="600" fill="%23008040"/%3E%3Crect y="280" width="800" height="320" fill="%23007000"/%3E%3Crect y="280" width="800" height="20" fill="%23ffffff"/%3E%3C/svg%3E');
}

/* Responsive */
@media (max-width: 960px) {
  .window {
    width: min(90vw, 520px);
  }

  .taskbar {
    flex-wrap: wrap;
    height: auto;
    gap: 4px;
  }

  .taskbar__items {
    order: 3;
    width: 100%;
  }
}
